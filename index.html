<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>RiegerÂ´s Gourmet Restaurant â€“ Reinigungsplan</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Manifest fÃ¼r Android/iPhone-Icon -->
  <link rel="manifest" href="manifest.json">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">

  <style>
    * { box-sizing: border-box; }

    body{
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin:0;
      padding:0;
      background:#ffffff;
      color:#000000;
    }

    .topbar{
      background:#ffffff;
      color:#000000;
      padding:12px 16px;
      border-bottom:1px solid #ddd;
      display:flex;
      align-items:center;
      gap:12px;
    }
    .topbar img{
      height:42px;
      object-fit:contain;
      display:block;
    }
    .topbar-title{
      font-weight:800;
      text-transform:uppercase;
      font-size:1rem;
      line-height:1.1;
    }
    .topbar-sub{
      font-size:0.85rem;
      color:#1f2937;
    }

    .container{
      max-width:1100px;
      margin:18px auto;
      padding:0 16px 26px;
    }

    .subtitle{
      font-size:0.95rem;
      color:#1f2937;
      margin:8px 0 14px;
    }

    .card{
      background:#ffffff;
      border-radius:14px;
      padding:18px;
      border:1px solid #ddd;
      box-shadow:0 2px 8px rgba(0,0,0,0.08);
      margin-bottom:18px;
    }

    .card-step{
      font-size:0.75rem;
      text-transform:uppercase;
      letter-spacing:0.08em;
      color:#1f2937;
      font-weight:700;
      margin-bottom:6px;
    }

    h2{
      margin:0 0 10px;
      color:#111827;
    }

    .category{
      text-align:center;
      font-weight:800;
      padding:10px;
      border-radius:10px;
      margin:18px 0 10px;
      font-size:0.9rem;
      letter-spacing:0.06em;
    }
    .category.daily{ background:#dbeafe; color:#1e40af; }
    .category.weekly{ background:#fde68a; color:#92400e; }
    .category.biweekly{ background:#d1d5db; color:#1f2937; }

    .button-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(190px, 1fr));
      gap:10px;
    }

    .btn{
      background:#f7f7f7;
      border:1px solid #cfcfcf;
      padding:12px 10px;
      text-align:center;
      border-radius:12px;
      font-weight:700;
      cursor:pointer;
      color:#000000;
      font-size:0.95rem;
      user-select:none;
    }
    .btn.selected{
      background:#e0edff;
      border-color:#2563eb;
    }

    .pin-hint{
      font-size:0.9rem;
      color:#1f2937;
      margin:0 0 10px;
    }

    .responsibility{
      margin:8px 0 12px;
      font-size:0.85rem;
      color:#1f2937;
      line-height:1.35;
    }

    input[type="text"]{
      width:100%;
      padding:12px;
      border-radius:10px;
      border:1px solid:#cfcfcf;
      margin-bottom:12px;
      font-size:1rem;
      outline:none;
    }

    .submit-btn{
      width:100%;
      padding:14px;
      background:#16a34a;
      border:none;
      border-radius:14px;
      font-size:1.05rem;
      font-weight:800;
      color:#ffffff;
      cursor:pointer;
    }
    .submit-btn:active{ transform:scale(0.99); }

    .logout-btn{
      width:100%;
      padding:14px;
      margin-top:10px;
      background:#dc2626;
      border:none;
      border-radius:14px;
      font-size:1.05rem;
      font-weight:800;
      color:#ffffff;
      cursor:pointer;
    }
    .logout-btn:active{ transform:scale(0.99); }

    .status{
      margin-top:10px;
      font-size:0.95rem;
      min-height:1.2em;
      font-weight:700;
    }
    .status.ok{ color:#166534; }
    .status.error{ color:#b91c1c; }

    .table-container{ overflow-x:auto; }

    table{
      width:100%;
      border-collapse:collapse;
      margin-top:12px;
      font-size:0.9rem;
    }
    th, td{
      padding:8px;
      border:1px solid #ddd;
      text-align:left;
      white-space:nowrap;
    }
    th{ background:#f3f4f6; }

    @media (max-width:600px){
      .button-grid{ grid-template-columns:1fr; }
      .topbar-title{ font-size:0.95rem; }
    }
  </style>
</head>

<body>

  <div class="topbar">
    <img src="Moebel_Rieger.png" alt="MÃ¶bel Rieger Logo">
    <div>
      <div class="topbar-title">RiegerÂ´s Gourmet Restaurant</div>
      <div class="topbar-sub">Digitale Reinigungsdokumentation â€“ KÃ¼che &amp; Theke</div>
    </div>
  </div>

  <div class="container">

    <div class="subtitle">
      Aufgabe wÃ¤hlen â†’ Mitarbeiter wÃ¤hlen â†’ PIN eingeben â†’ bestÃ¤tigen. Unten siehst du sofort das heutige Protokoll.
    </div>

    <!-- Schritt 1 -->
    <div class="card">
      <div class="card-step">Schritt 1 â€“ Pflicht</div>
      <h2>Aufgabe wÃ¤hlen</h2>

      <div class="category daily">TÃ„GLICH</div>
      <div class="button-grid">
        <div class="btn task">Theke â€“ Essensausgabe</div>
        <div class="btn task">Theke â€“ Kuchen / Dessert</div>
        <div class="btn task">Theke â€“ Salat</div>
        <div class="btn task">Kaffeemaschine links/rechts</div>
        <div class="btn task">GetrÃ¤nkeautomat</div>
      </div>

      <div class="category weekly">WÃ–CHENTLICH</div>
      <div class="button-grid">
        <div class="btn task">Fritteusen links/rechts</div>
      </div>

      <div class="category biweekly">ALLE 2 WOCHEN</div>
      <div class="button-grid">
        <div class="btn task">KÃ¼che â€“ Abzugshaube</div>
        <div class="btn task">Ausgabe â€“ rechts</div>
        <div class="btn task">Ausgabe â€“ links</div>
      </div>
    </div>

    <!-- Schritt 2 -->
    <div class="card">
      <div class="card-step">Schritt 2 â€“ Pflicht</div>
      <h2>Mitarbeiter wÃ¤hlen</h2>

      <div class="button-grid">
        <div class="btn staff">Tatiana Harpeng</div>
        <div class="btn staff">Thomas Kopp</div>
        <div class="btn staff">Gina Marie NaÃŸ</div>
        <div class="btn staff">Olga Sirghi</div>
        <div class="btn staff">Daiva Stariene</div>
      </div>
    </div>

    <!-- Schritt 3 -->
    <div class="card">
      <div class="card-step">Schritt 3 â€“ Pflicht</div>
      <h2>Reinigung bestÃ¤tigen</h2>

      <p class="pin-hint">PIN eingeben (Mitarbeiter-Code) und dann â€žReinigung bestÃ¤tigenâ€œ klicken.</p>

      <p class="responsibility">
        Mit dem Klick auf â€žReinigung bestÃ¤tigenâ€œ erklÃ¤rst du verbindlich, dass du die ausgewÃ¤hlte Reinigung selbst und ordnungsgemÃ¤ÃŸ
        durchgefÃ¼hrt hast. Du bist dafÃ¼r verantwortlich, deinen persÃ¶nlichen PIN vor der Nutzung durch Dritte zu schÃ¼tzen.
      </p>

      <input type="text" id="pin" placeholder="PIN eingeben" inputmode="numeric" autocomplete="off">

      <button class="submit-btn" id="submit">Reinigung bestÃ¤tigen</button>
      <button class="logout-btn" id="clearPin">Abmelden / PIN lÃ¶schen</button>

      <div class="status" id="status"></div>
    </div>

    <!-- Protokoll -->
    <div class="card">
      <div class="card-step">Protokoll</div>
      <h2>Heutiges Protokoll</h2>

      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Datum</th>
              <th>Uhrzeit</th>
              <th>Aufgabe</th>
              <th>Mitarbeiter</th>
            </tr>
          </thead>
          <tbody id="log-body"></tbody>
        </table>
      </div>
    </div>

  </div>

  <script>
    // ðŸ‘‰ HIER deine eigene /exec-URL eintragen:
    const WEBHOOK_URL = "https://script.google.com/macros/s/AKfycbxGLD7V0pxnNAIhD4H0_VYOvDIBE5k8GK_qNc_zc2kshUZbWgmasKpmRS2Mh6Ww1vjJNw/exec";

    // Feste PINs pro Mitarbeiter (Name -> PIN)
    const STAFF_PINS = {
      "Tatiana Harpeng": "4827",
      "Thomas Kopp": "6194",
      "Gina Marie NaÃŸ": "7352",
      "Olga Sirghi": "8046",
      "Daiva Stariene": "2918"
    };

    let selectedTask = null;
    let selectedStaff = null;

    const pinEl    = document.getElementById("pin");
    const statusEl = document.getElementById("status");
    const logBody  = document.getElementById("log-body");

    function setStatus(msg, isError){
      statusEl.textContent = msg;
      statusEl.className   = "status " + (isError ? "error" : "ok");
    }

    function clearSelections(){
      selectedTask = null;
      selectedStaff = null;
      document.querySelectorAll(".task").forEach(b => b.classList.remove("selected"));
      document.querySelectorAll(".staff").forEach(b => b.classList.remove("selected"));
    }

    function addRow(entry){
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${entry.date}</td>
        <td>${entry.time}</td>
        <td>${entry.task}</td>
        <td>${entry.staff}</td>
      `;
      if (logBody.firstChild) {
        logBody.insertBefore(tr, logBody.firstChild);
      } else {
        logBody.appendChild(tr);
      }

      // nur die letzten 30 EintrÃ¤ge anzeigen
      while (logBody.rows.length > 30) {
        logBody.deleteRow(logBody.rows.length - 1);
      }
    }

    // Aufgaben auswÃ¤hlen
    document.querySelectorAll(".task").forEach(btn => {
      btn.addEventListener("click", () => {
        document.querySelectorAll(".task").forEach(b => b.classList.remove("selected"));
        btn.classList.add("selected");
        selectedTask = btn.innerText;
      });
    });

    // Mitarbeiter auswÃ¤hlen
    document.querySelectorAll(".staff").forEach(btn => {
      btn.addEventListener("click", () => {
        document.querySelectorAll(".staff").forEach(b => b.classList.remove("selected"));
        btn.classList.add("selected");
        selectedStaff = btn.innerText;
        pinEl.focus();
      });
    });

    // Reinigung bestÃ¤tigen
    document.getElementById("submit").addEventListener("click", () => {
      const pin = pinEl.value.trim();

      if (!selectedTask || !selectedStaff) {
        setStatus("Bitte zuerst Aufgabe und Mitarbeiter auswÃ¤hlen.", true);
        return;
      }
      if (!pin) {
        setStatus("Bitte PIN eingeben.", true);
        pinEl.focus();
        return;
      }

      // PIN prÃ¼fen
      const expectedPin = STAFF_PINS[selectedStaff];
      if (!expectedPin) {
        setStatus("FÃ¼r diesen Mitarbeiter ist noch keine PIN hinterlegt.", true);
        return;
      }
      if (pin !== expectedPin) {
        setStatus("Falscher PIN. Bitte erneut eingeben.", true);
        pinEl.focus();
        return;
      }

      const now = new Date();
      const entry = {
        task:  selectedTask,
        staff: selectedStaff,
        date:  now.toLocaleDateString("de-DE"),
        time:  now.toLocaleTimeString("de-DE"),
        pin:   pin,
        timestamp_iso: now.toISOString()
      };

      // Lokal anzeigen
      addRow(entry);
      setStatus("Eintrag gespeichert.", false);

            // An Google schicken
      if (WEBHOOK_URL) {
        try {
          fetch(WEBHOOK_URL, {
            method: "POST",
            mode: "no-cors", // wichtig: Browser soll nicht meckern
            body: JSON.stringify({
              date:         entry.date,
              time:         entry.time,
              task_label:   entry.task,
              person_label: entry.staff,
              pin:          entry.pin,
              timestamp_iso: entry.timestamp_iso
            })
          });
        } catch (e) {
          // Wenn was schiefgeht, ist nur die Verbindung betroffen, nicht die App
        }
      }


      // PIN bleibt aktiv fÃ¼r weitere Aufgaben
      pinEl.focus();
    });

    // Abmelden / PIN lÃ¶schen
    document.getElementById("clearPin").addEventListener("click", () => {
      pinEl.value = "";
      clearSelections();
      setStatus("Abgemeldet. PIN wurde gelÃ¶scht.", false);
      pinEl.focus();
    });

    // Start-Fokus
    pinEl.focus();
  </script>

</body>
</html>
<script>
  if ("scrollRestoration" in history) {
    history.scrollRestoration = "manual";
  }

  function scrollTopHard() {
    window.scrollTo({ top: 0, left: 0, behavior: "auto" });
    document.documentElement.scrollTop = 0;
    document.body.scrollTop = 0;
  }

  window.addEventListener("load", () => {
    scrollTopHard();
    setTimeout(scrollTopHard, 50);
    setTimeout(scrollTopHard, 250);
  });
</script>







